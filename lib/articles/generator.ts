import { slugify, getRandomInt } from '../utils';

// 記事カテゴリタイプ
export type ArticleCategory = 'study' | 'career' | 'community' | 'part-time';

// 生成される記事の型
export interface GeneratedArticle {
  title: string;
  content: string;
  summary: string;
  slug: string;
  tags: string[];
}

// 各カテゴリのダミー記事テンプレート
const CATEGORY_TEMPLATES: Record<ArticleCategory, Omit<GeneratedArticle, 'slug'>> = {
  study: {
    title: '効率的な学習方法',
    content: `
# 効率的な学習方法

大学での勉強は高校までとは大きく異なります。自己管理能力と効率的な学習方法が求められます。

## ポモドーロテクニック

25分の集中作業と5分の休憩を繰り返す方法です。この方法を使うことで、脳が疲れすぎることなく効率よく勉強できます。

## アクティブラーニング

単に教科書を読むだけでなく、情報を積極的に処理することが重要です。例えば：
- 読んだ内容を自分の言葉で要約する
- 友人に教えるつもりで説明してみる
- 実際に問題を解いてみる

## 定期的な復習

新しい情報は時間とともに忘れていきます。定期的な復習スケジュールを組むことで記憶の定着率を高められます。

## デジタルツールの活用

Anki（フラッシュカードアプリ）やNotion（ノート管理アプリ）などのデジタルツールを活用することで、勉強の効率を上げることができます。
    `,
    summary: '大学での効率的な学習方法とテクニックを紹介します。ポモドーロテクニック、アクティブラーニング、定期的な復習、デジタルツールの活用法などを解説しています。',
    tags: ['勉強法', '時間管理', '大学生活']
  },
  career: {
    title: '就活の始め方',
    content: `
# 就活の始め方

就職活動は大学生活の重要なマイルストーンです。計画的に準備を進めることが成功への鍵となります。

## 自己分析

自分の強み、弱み、価値観、興味があることを明確にしましょう。これが就活の土台となります。

## 業界研究

興味のある業界について調査しましょう。業界の動向、主要企業、求められるスキルなどを理解することが重要です。

## インターンシップ

可能であれば、インターンシップに参加しましょう。実際の職場環境を体験することで、自分に合った仕事を見つける助けになります。

## エントリーシートと面接対策

エントリーシートは丁寧に作成し、面接では自信を持って自己アピールできるよう準備しましょう。模擬面接を友人や大学のキャリアセンターと行うことも効果的です。
    `,
    summary: '大学生のための就職活動の始め方ガイド。自己分析、業界研究、インターンシップの活用、エントリーシート・面接対策など、効果的な就活準備の方法を解説します。',
    tags: ['就活', 'キャリア', '自己分析']
  },
  community: {
    title: 'サークル活動の魅力',
    content: `
# サークル活動の魅力

大学のサークル活動は、勉強だけでは得られない貴重な経験とつながりを提供してくれます。

## 新しい友人との出会い

サークルでは、学部や学年を越えて多くの仲間と出会うことができます。共通の興味を持つ人々との交流は、大学生活を豊かにします。

## スキルの習得

多くのサークルでは、特定のスキルや知識を身につける機会があります。例えば、スポーツサークルでは体力や協調性を、文化系サークルでは創造性や専門的なスキルを磨くことができます。

## リーダーシップの経験

サークルの運営に関わることで、リーダーシップやマネジメントのスキルを実践的に学ぶことができます。これは将来のキャリアにも役立つ経験となります。

## 大学生活の充実

定期的な活動や合宿、イベントなどを通じて、大学生活に楽しい思い出を作ることができます。
    `,
    summary: '大学のサークル活動がもたらす様々なメリットについて解説。新たな友人関係の構築、スキル習得、リーダーシップ経験、充実した大学生活など、サークル参加の魅力を紹介します。',
    tags: ['サークル', 'コミュニティ', '大学生活']
  },
  'part-time': {
    title: 'バイトと学業の両立方法',
    content: `
# バイトと学業の両立方法

アルバイトは社会経験と収入を得る貴重な機会ですが、学業とのバランスが重要です。

## 無理のないシフト設定

学期中は週に2〜3日、テスト期間前は減らすなど、学業に支障が出ないようにシフトを調整しましょう。シフトの融通が利くかどうかは仕事選びの重要な基準です。

## 効率的な時間管理

限られた時間を有効活用するため、タスク管理アプリや手帳を使って計画的に行動しましょう。通学時間や休憩時間も勉強に活用できます。

## 優先順位の明確化

大学生の本分は「学ぶこと」です。バイトが忙しくても授業や課題を疎かにしないよう、常に優先順位を意識しましょう。

## 体調管理

無理なバイトは体調不良につながり、結果的に学業にも影響します。十分な睡眠と休息を確保することも重要です。
    `,
    summary: '大学生がアルバイトと学業を両立させるためのアドバイス。無理のないシフト設定、効率的な時間管理、優先順位の明確化、体調管理など、バランスを保つためのコツを紹介します。',
    tags: ['アルバイト', '時間管理', '学生生活']
  }
};

/**
 * タイトルにランダムな変化をつける
 */
function addTitleVariation(title: string): string {
  const prefixes = [
    '【初心者向け】',
    '知っておきたい',
    '今すぐ実践できる',
    '大学生必見！',
    '成功するための',
    '失敗しない',
    '実践的な',
    '効果的な',
    '学生のための'
  ];
  
  const randomIndex = getRandomInt(0, prefixes.length - 1);
  return `${prefixes[randomIndex]}${title}`;
}

/**
 * カテゴリに基づいて記事を生成する関数
 * 現在はダミーデータを返す実装
 */
export async function generateArticle(category: ArticleCategory): Promise<GeneratedArticle> {
  const template = CATEGORY_TEMPLATES[category];
  const title = addTitleVariation(template.title);
  const slug = `${category}-${slugify(title)}-${Date.now().toString().slice(-6)}`;
  
  return {
    ...template,
    title,
    slug,
  };
} 